

tickers = ['AAPL', 'SPY']
df_raw_multi = yf.download(tickers, start='2021-06-01', end='2025-01-01')

Trial 49 finished with value: 0.008415046214846327 and parameters: {'input_size': 50, 'patch_len': 8, 'stride': 4, 'encoder_layers': 3, 'n_heads': 2, 'hidden_size': 32, 'linear_hidden_size': 64, 'dropout': 0.18395550206607456, 'learning_rate': 0.0005461962534971316}. Best is trial 49 with value: 0.008415046214846327.
Best params: {'input_size': 50, 'patch_len': 8, 'stride': 4, 'encoder_layers': 3, 'n_heads': 2, 'hidden_size': 32, 'linear_hidden_size': 64, 'dropout': 0.18395550206607456, 'learning_rate': 0.0005461962534971316}
Best MAE:    0.008415046214846327
    number     value             datetime_start          datetime_complete  \
21      21  0.004858 2026-02-20 03:16:39.809982 2026-02-20 03:17:06.562516   
23      23  0.005296 2026-02-20 03:17:17.758034 2026-02-20 03:17:43.691314   
39      39  0.005307 2026-02-20 03:21:48.339968 2026-02-20 03:22:16.126725   
25      25  0.005417 2026-02-20 03:17:57.137301 2026-02-20 03:18:23.756240   
5        5  0.005645 2026-02-20 03:11:00.856503 2026-02-20 03:11:27.588393   
12      12  0.005923 2026-02-20 03:13:27.808246 2026-02-20 03:13:58.994419   
46      46  0.006146 2026-02-20 03:23:32.185873 2026-02-20 03:23:55.224581   
9        9  0.006294 2026-02-20 03:12:21.871730 2026-02-20 03:12:51.619882   
28      28  0.006740 2026-02-20 03:19:04.181938 2026-02-20 03:19:27.033046   
16      16  0.006947 2026-02-20 03:14:40.186908 2026-02-20 03:15:11.705655   

                 duration  params_dropout  params_encoder_layers  \
21 0 days 00:00:26.752534        0.054629                      2   
23 0 days 00:00:25.933280        0.103596                      2   
39 0 days 00:00:27.786757        0.207730                      2   
25 0 days 00:00:26.618939        0.168363                      2   
5  0 days 00:00:26.731890        0.205047                      2   
12 0 days 00:00:31.186173        0.128091                      3   
46 0 days 00:00:23.038708        0.125214                      1   
9  0 days 00:00:29.748152        0.290226                      3   
28 0 days 00:00:22.851108        0.186700                      1   
16 0 days 00:00:31.518747        0.162851                      3   

    params_hidden_size  params_input_size  params_learning_rate  \
21                  64                 80              0.000284   
23                  64                 80              0.000174   
39                  32                 30              0.000110   
25                  64                 40              0.000441   
5                   64                 70              0.000243   
12                  64                 30              0.000926   
46                  64                 70              0.000258   
9                   64                 40              0.000650   
28                 128                100              0.000204   
16                  64                120              0.000249   

    params_linear_hidden_size  params_n_heads  params_patch_len  \
21                         64               2                16   
23                         64               2                16   
39                         64               4                16   
25                        256               4                 4   
5                         256               8                16   
12                         64               4                 4   
46                        128               4                16   
9                         256               4                 4   
28                        128               8                 8   
16                         64               2                 4   

    params_stride   state  
21              4  PRUNED  
23              4  PRUNED  
39              2  PRUNED  
25              4  PRUNED  
5               8  PRUNED  
12              4  PRUNED  
46              8  PRUNED  
9               4  PRUNED  
28              8  PRUNED  
16              4  PRUNED  